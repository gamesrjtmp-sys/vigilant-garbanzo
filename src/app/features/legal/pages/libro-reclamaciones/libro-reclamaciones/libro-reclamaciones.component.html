<div class="animate-in fade-in slide-in-from-bottom-4 duration-500 font-sans">
  
  <!-- HEADER: T铆tulo (Solo se muestra si NO hay 茅xito para no duplicar visualmente) -->
  @if (!exito()) {
    <div class="flex items-center gap-4 mb-8">
      <div class="w-16 h-16 bg-white border border-gray-200 rounded-xl flex items-center justify-center shadow-sm">
        <!-- Icono Libro -->
        <span class="text-3xl"></span>
      </div>
      <div>
        <h2 class="text-2xl font-bold text-gray-900 m-0">Libro de Reclamaciones</h2>
        <p class="text-sm text-gray-500 m-0">Conforme al C贸digo de Protecci贸n y Defensa del Consumidor.</p>
      </div>
    </div>
  }

  @if (exito()) {
    <!-- ========================================== -->
    <!-- VISTA DE XITO (TICKET GENERADO)           -->
    <!-- ========================================== -->
    <div class="max-w-md mx-auto bg-white rounded-3xl shadow-2xl border border-emerald-100 overflow-hidden text-center relative animate-in zoom-in-95 duration-500">
      
      <!-- Borde Superior Decorativo -->
      <div class="h-2 w-full bg-gradient-to-r from-emerald-400 to-teal-500"></div>

      <div class="p-8 sm:p-12">
        
        <!-- Icono Check Animado -->
        <div class="w-24 h-24 bg-emerald-50 rounded-full flex items-center justify-center mx-auto mb-6 relative">
           <div class="absolute inset-0 rounded-full border border-emerald-200 animate-ping opacity-50"></div>
           <svg class="w-10 h-10 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
        </div>

        <h3 class="text-2xl font-extrabold text-gray-900 mb-2">隆Enviado Correctamente!</h3>
        <p class="text-gray-500 text-sm mb-8">Hemos registrado tu hoja de reclamaci贸n en nuestro sistema.</p>

        <!-- TICKET DE CONSTANCIA -->
        <div class="bg-gray-50 rounded-2xl p-6 border border-gray-100 mb-8 relative group">
           <!-- Decoraci贸n ticket (muescas laterales) -->
           <div class="absolute top-1/2 -left-3 w-6 h-6 bg-white rounded-full border-r border-gray-100"></div>
           <div class="absolute top-1/2 -right-3 w-6 h-6 bg-white rounded-full border-l border-gray-100"></div>

           <p class="text-[10px] uppercase font-bold text-gray-400 tracking-widest mb-1">C贸digo de Reclamo</p>
           <p class="text-3xl font-mono font-bold text-emerald-700 tracking-wider select-all">{{ codigoGenerado() }}</p>
           <p class="text-[10px] text-gray-400 mt-2">Guarda este c贸digo para seguimiento</p>
        </div>

        <!-- AVISO LEGAL (15 DAS) -->
        <div class="flex gap-4 items-start text-left bg-blue-50 p-4 rounded-xl border border-blue-100 mb-8">
           <div class="text-xl"></div>
           <div>
             <p class="text-xs font-bold text-blue-900 uppercase mb-0.5">Plazo de Atenci贸n</p>
             <p class="text-sm text-blue-800 leading-snug">
               Conforme a ley, atenderemos tu reclamo y te daremos respuesta en un plazo m谩ximo de <strong>15 d铆as h谩biles</strong> a trav茅s de tu correo electr贸nico o tel茅fono.
             </p>
           </div>
        </div>

        <button (click)="exito.set(false)" class="text-sm font-bold text-gray-500 hover:text-black underline decoration-gray-300 underline-offset-4 transition-colors">
          Volver al formulario
        </button>

      </div>
    </div>

  } @else {
    <!-- ========================================== -->
    <!-- FORMULARIO DE RECLAMO                      -->
    <!-- ========================================== -->
    <form [formGroup]="claimForm" (ngSubmit)="enviarReclamo()" class="space-y-8 bg-white p-8 rounded-2xl border border-gray-200 shadow-sm relative">
      
      <!-- 1. Identificaci贸n del Consumidor -->
      <div class="space-y-5">
        <h3 class="text-sm font-bold text-gray-900 uppercase tracking-wider border-b border-gray-100 pb-2">1. Identificaci贸n del Consumidor</h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
          <!-- Nombre -->
          <div>
            <label class="block text-xs font-bold text-gray-500 mb-1">Nombre Completo <span class="text-red-500">*</span></label>
            <input formControlName="nombre" type="text" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none transition" 
                   [class.border-red-500]="claimForm.get('nombre')?.invalid && claimForm.get('nombre')?.touched">
            @if (claimForm.get('nombre')?.invalid && claimForm.get('nombre')?.touched) {
              <span class="text-red-500 text-xs mt-1 block">Ingresa tu nombre completo.</span>
            }
          </div>
          
          <!-- DNI -->
          <div>
            <label class="block text-xs font-bold text-gray-500 mb-1">DNI / CE <span class="text-red-500">*</span></label>
            <input formControlName="documento" type="text" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none transition"
                   [class.border-red-500]="claimForm.get('documento')?.invalid && claimForm.get('documento')?.touched">
            @if (claimForm.get('documento')?.invalid && claimForm.get('documento')?.touched) {
              <span class="text-red-500 text-xs mt-1 block">M铆nimo 8 caracteres.</span>
            }
          </div>
          
          <!-- Celular -->
          <div>
            <label class="block text-xs font-bold text-gray-500 mb-1">Celular <span class="text-red-500">*</span></label>
            <input formControlName="telefono" type="tel" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none transition"
                   [class.border-red-500]="claimForm.get('telefono')?.invalid && claimForm.get('telefono')?.touched">
            @if (claimForm.get('telefono')?.invalid && claimForm.get('telefono')?.touched) {
              <span class="text-red-500 text-xs mt-1 block">N煤mero de contacto requerido.</span>
            }
          </div>
          
          <!-- Email -->
          <div>
            <label class="block text-xs font-bold text-gray-500 mb-1">Email <span class="text-red-500">*</span></label>
            <input formControlName="email" type="email" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none transition"
                   [class.border-red-500]="claimForm.get('email')?.invalid && claimForm.get('email')?.touched">
            @if (claimForm.get('email')?.invalid && claimForm.get('email')?.touched) {
              <span class="text-red-500 text-xs mt-1 block">Correo inv谩lido.</span>
            }
          </div>
        </div>
        
        <!-- Direcci贸n -->
        <div>
          <label class="block text-xs font-bold text-gray-500 mb-1">Direcci贸n <span class="text-red-500">*</span></label>
          <input formControlName="direccion" type="text" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none transition"
                 [class.border-red-500]="claimForm.get('direccion')?.invalid && claimForm.get('direccion')?.touched">
          @if (claimForm.get('direccion')?.invalid && claimForm.get('direccion')?.touched) {
            <span class="text-red-500 text-xs mt-1 block">La direcci贸n es obligatoria para notificaciones f铆sicas.</span>
          }
        </div>
      </div>

      <!-- 2. Detalle de la Reclamaci贸n -->
      <div class="space-y-5">
        <h3 class="text-sm font-bold text-gray-900 uppercase tracking-wider border-b border-gray-100 pb-2">2. Detalle de la Reclamaci贸n</h3>
        
        <!-- Radio Buttons Tipo -->
        <div class="flex gap-6">
          <label class="flex items-center gap-2 cursor-pointer group">
            <input type="radio" formControlName="tipo" value="RECLAMO" class="accent-black w-4 h-4">
            <span class="text-sm font-bold group-hover:text-black">Reclamo</span>
            <span class="text-xs text-gray-400">(Producto/Servicio)</span>
          </label>
          <label class="flex items-center gap-2 cursor-pointer group">
            <input type="radio" formControlName="tipo" value="QUEJA" class="accent-black w-4 h-4">
            <span class="text-sm font-bold group-hover:text-black">Queja</span>
            <span class="text-xs text-gray-400">(Atenci贸n)</span>
          </label>
        </div>

        <!-- Detalle -->
        <div>
          <label class="block text-xs font-bold text-gray-500 mb-1">Detalle del suceso <span class="text-red-500">*</span></label>
          <textarea formControlName="detalle" rows="4" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none resize-none transition" placeholder="Describa aqu铆 lo ocurrido con el mayor detalle posible..." 
                    [class.border-red-500]="claimForm.get('detalle')?.invalid && claimForm.get('detalle')?.touched"></textarea>
          @if (claimForm.get('detalle')?.invalid && claimForm.get('detalle')?.touched) {
             <span class="text-red-500 text-xs mt-1 block">Por favor detalla lo sucedido (m铆nimo 10 caracteres).</span>
          }
        </div>
        
        <!-- Pedido Opcional -->
        <div>
          <label class="block text-xs font-bold text-gray-500 mb-1">Pedido Relacionado (Opcional)</label>
          <input formControlName="pedido" type="text" placeholder="Ej: Pedido #12345" class="w-full border border-gray-300 rounded-lg p-3 text-sm focus:ring-2 focus:ring-black outline-none">
        </div>
      </div>

      <!-- BOTONES Y LEGAL -->
      <div class="pt-6 flex flex-col md:flex-row gap-4 items-center justify-between">
        
        <!-- BOTN DE ENVO -->
        <!-- NOTA: Ya NO tiene [disabled]="invalid". Se habilita siempre para permitir feedback visual al hacer clic. -->
        <button 
          type="submit" 
          [disabled]="enviando()" 
          class="bg-black text-white font-bold py-4 px-8 rounded-xl hover:bg-gray-800 transition-all shadow-lg hover:shadow-xl hover:-translate-y-0.5 w-full md:w-auto disabled:bg-gray-300 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-3"
        >
          @if (enviando()) {
            <!-- Spinner -->
            <svg class="animate-spin h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span>Enviando...</span>
          } @else {
            <span>Enviar Hoja de Reclamaci贸n</span>
            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"/></svg>
          }
        </button>

        <p class="text-xs text-gray-400 text-center md:text-right">
          Al enviar, aceptas nuestras <a routerLink="/legal/privacidad" class="underline hover:text-black">pol铆ticas de privacidad</a>.
        </p>

      </div>

    </form>
  }
</div>