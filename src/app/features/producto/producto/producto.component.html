<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 font-sans text-gray-900">

  <!-- LOADING STATE (Skeleton elegante) -->
  @if (loading()) {
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 animate-pulse">
      <div class="bg-gray-100 h-[600px] rounded-xl"></div>
      <div class="space-y-6 py-10">
        <div class="h-10 bg-gray-100 rounded w-3/4"></div>
        <div class="h-6 bg-gray-100 rounded w-1/4"></div>
        <div class="h-32 bg-gray-100 rounded"></div>
        <div class="h-16 bg-gray-100 rounded"></div>
      </div>
    </div>
  } 
  @else {
    
    @if (producto(); as p) {
      
      <!-- LAYOUT PRINCIPAL -->
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-8 lg:gap-16">

        <!-- COLUMNA IZQUIERDA: GALER√çA VISUAL (Ocupa 7 columnas) -->
        <div class="lg:col-span-7 flex flex-col-reverse lg:flex-row gap-4">
          
          <!-- Thumbnails -->
          <div class="flex lg:flex-col gap-4 overflow-x-auto lg:overflow-visible pb-2 lg:pb-0 scrollbar-hide w-full lg:w-24 shrink-0">
            @for (img of p.Imagenes; track $index) {
              <button 
                (click)="seleccionarImagen(img)"
                class="relative w-20 h-20 lg:w-24 lg:h-24 rounded-lg overflow-hidden border-2 transition-all duration-200 shrink-0"
                [class.border-black]="img === imagenSeleccionada()"
                [class.border-transparent]="img !== imagenSeleccionada()"
                [class.opacity-50]="img !== imagenSeleccionada()"
                [class.hover:opacity-100]="img !== imagenSeleccionada()"
              >
                <img [src]="img" [alt]="p.Nombre" class="w-full h-full object-cover">
              </button>
            }
          </div>

          <!-- Imagen Principal -->
          <div class="flex-1 bg-[#F9F9F9] rounded-2xl overflow-hidden relative group cursor-zoom-in min-h-[400px] lg:min-h-[600px] flex items-center justify-center">
            <img 
              [src]="imagenSeleccionada()" 
              [alt]="p.Nombre" 
              class="w-full h-full object-contain mix-blend-multiply hover:scale-105 transition-transform duration-500"
            />
            <!-- Badge Flotante -->
            @if(p.Precio) {
              <span class="absolute top-4 right-4 bg-black text-white text-xs font-bold px-3 py-1.5 uppercase tracking-widest rounded-full">
                Sale
              </span>
            }
          </div>
        </div>

        <!-- COLUMNA DERECHA: INFORMACI√ìN Y COMPRA (Ocupa 5 columnas) -->
        <div class="lg:col-span-5 flex flex-col pt-2">
          
          <!-- Header del Producto -->
          <div class="mb-6 border-b border-gray-200 pb-6">
            <h1 class="text-4xl lg:text-5xl font-serif font-medium leading-tight mb-2 text-gray-900">
              {{ p.Nombre }}
            </h1>

            <!-- RESE√ëAS DIN√ÅMICAS (Clickeable para scroll) -->
            <div 
              class="flex items-center gap-2 mb-4 cursor-pointer group w-fit" 
              (click)="scrollToReviews()" 
              title="Ver todas las opiniones"
            >
              <div class="flex text-yellow-400 text-sm">
                <!-- Generamos estrellas llenas/vac√≠as seg√∫n el promedio real -->
                @for(star of [1,2,3,4,5]; track star) { 
                   <svg class="w-6 h-6" 
                        [class.text-gray-200]="star > reviewsSummary().average" 
                        [class.fill-current]="star <= reviewsSummary().average" 
                        [class.text-yellow-400]="star <= reviewsSummary().average" 
                        viewBox="0 0 20 20" fill="currentColor">
                      <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                   </svg> 
                }
              </div>
              <span class="text-sm font-medium text-gray-500 underline decoration-gray-300 underline-offset-4 group-hover:text-black group-hover:decoration-black transition-all">
                {{ reviewsSummary().average | number:'1.1-1' }} ‚Ä¢ {{ reviewsSummary().count }} Rese√±as verificadas
              </span>
            </div>

            <!-- üî• SECCI√ìN DE PRECIO (MEJORADA) -->
            <div class="flex items-end gap-3 mt-4">
               <div class="flex flex-col">
                  <span class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">Precio Online</span>
                  <span class="text-5xl font-serif font-medium text-gray-900 tracking-tight">
                    S/ {{ p.Precio | number:'1.2-2' }}
                  </span>
               </div>
               
               <!-- Precio Original Tachado (Anclaje) -->
               <div class="flex flex-col pb-2">
                  <span class="text-lg text-gray-400 line-through decoration-gray-300">
                    S/ {{ (p.Precio * 2) | number:'1.2-2' }}
                  </span>
                  <!-- Badge de Ahorro -->
                  <span class="bg-red-100 text-red-700 text-[10px] font-bold px-2 py-0.5 rounded-full mt-1">
                    Ahorras 50%
                  </span>
               </div>
            </div>

            

            <div class="inline-block bg-[#D6F379] px-3 py-1 rounded text-sm font-bold text-black transform -rotate-1">
              ¬°Hemos aplicado un 50% de DCTO por OCASIN!
            </div>
            <br>
            <!-- <p class="text-gray-600 leading-relaxed text-lg mb-4">
              {{ p.Descripcion }}
            </p> -->
          </div>

          <!-- Trust Icons -->
          <div class="grid grid-cols-2 gap-4 mb-8">
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">üë©‚Äç‚öïÔ∏è</div>
              <span class="text-xs font-bold uppercase tracking-wider">Dermatol√≥gicamente Probado</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">üåø</div>
              <span class="text-xs font-bold uppercase tracking-wider">Ingredientes Naturales</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">üê∞</div>
              <span class="text-xs font-bold uppercase tracking-wider">Cruelty Free & Vegano</span>
            </div>
            <div class="flex items-center gap-3">
              <div class="w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center">‚ú®</div>
              <span class="text-xs font-bold uppercase tracking-wider">F√≥rmula Hipoalerg√©nica</span>
            </div>
          </div>

           <!-- ============================================== -->
          <!-- BLOQUE DE ADD-ON (Pastillas Extra - Cantidad)  -->
          <!-- ============================================== -->
          @if (showAddonBlock() && extraColageno(); as extra) {
            
            <div class="bg-blue-50/30 border border-blue-100 rounded-2xl p-4 mb-8 transition-all duration-300"
                 [class.border-blue-500]="extraQuantity() > 0"
                 [class.bg-blue-50]="extraQuantity() > 0">
              
              <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-4">
                
                <!-- Info + Imagen del Extra -->
                <div class="flex-1 flex gap-4 items-center">
                  
                  <!-- Imagen Peque√±a del Add-on -->
                  <div class="w-24 h-24 bg-white rounded-lg border border-gray-100 overflow-hidden shrink-0 shadow-sm">
                     <img [src]="carritoService.getProductImage(extra)" [alt]="extra.Nombre" class="w-full h-full object-cover">
                  </div>


                  <div>
                    <div class="flex items-center gap-2 mb-1">
                      <span class="bg-blue-100 text-blue-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase tracking-wide">Respuesto</span>
                      <h4 class="text-sm font-bold text-gray-900 leading-tight">{{ extra.Nombre }}</h4>
                    </div>
                    <p class="text-xs text-gray-500 leading-snug max-w-xs mb-1">
                      {{ extra.Descripcion }}
                    </p>
                    <p class="text-sm font-bold text-blue-700">
                      S/ {{ extra.Precio }} <span class="text-gray-400 font-normal text-xs">/ caja</span>
                    </p>
                  </div>
                </div>

                <!-- Selector de Cantidad -->
                <div class="flex items-center gap-3 self-end sm:self-center">
                  <div class="flex items-center bg-white border border-gray-200 rounded-xl shadow-sm h-10">
                    <button 
                      (click)="updateExtraQuantity(-1)"
                      class="w-10 h-full flex items-center justify-center text-gray-500 hover:text-black hover:bg-gray-50 rounded-l-xl transition-colors disabled:opacity-30"
                      [disabled]="extraQuantity() === 0">
                      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"/></svg>
                    </button>
                    
                    <div class="w-8 text-center font-bold text-gray-900 text-sm">
                      {{ extraQuantity() }}
                    </div>

                    <button 
                      (click)="updateExtraQuantity(1)"
                      class="w-10 h-full flex items-center justify-center text-gray-500 hover:text-black hover:bg-gray-50 rounded-r-xl transition-colors">
                      <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/></svg>
                    </button>
                  </div>
                </div>

              </div>

              <!-- Subtotal del Extra (Feedback Visual) -->
              @if (extraQuantity() > 0) {
                <div class="mt-3 pt-3 border-t border-blue-200 flex justify-between items-center text-sm animate-in fade-in slide-in-from-top-1">
                  <span class="text-blue-800 font-medium text-xs">Agregado al pedido:</span>
                  <span class="font-bold text-blue-900 text-base">+ S/ {{ (extra.Precio * extraQuantity()) | number:'1.2-2' }}</span>
                </div>
              }
            </div>

          }
          <!-- Fin Bloque Add-on -->

          <!-- Widget de Suscripci√≥n (Opcional) -->
            <!-- <div class="border border-gray-300 rounded-xl overflow-hidden mb-6">
              <label class="relative flex items-center p-4 cursor-pointer border-b border-gray-200 bg-gray-50 hover:bg-gray-100 transition">
                <input type="radio" name="purchaseType" class="w-5 h-5 text-black focus:ring-black border-gray-300" checked>
                <div class="ml-3 flex-1">
                  <div class="flex justify-between items-center">
                    <span class="font-bold text-gray-900">Suscr√≠bete y Ahorra</span>
                    <span class="bg-[#78Daca] text-black text-xs font-bold px-2 py-0.5 rounded">Ahorra 33%</span>
                  </div>
                  <p class="text-sm text-gray-500 mt-1">Suministro de 4 meses ‚Ä¢ Cancela cuando quieras</p>
                </div>
              </label>
              <label class="relative flex items-center p-4 cursor-pointer hover:bg-gray-50 transition">
                <input type="radio" name="purchaseType" class="w-5 h-5 text-black focus:ring-black border-gray-300">
                <div class="ml-3 flex-1 flex justify-between">
                  <span class="font-medium text-gray-900">Compra √önica</span>
                  <span class="font-bold text-gray-900">S/ {{ p.Precio | number:'1.2-2' }}</span>
                </div>
              </label>
            </div> -->



          <!-- ================================================== -->
          <!-- üëá AQU√ç EST√Å EL CAMBIO: DOS BOTONES DE ACCI√ìN üëá -->
          <!-- ================================================== -->
          <div class="flex flex-col gap-3">
            
            <div class="flex gap-3">
              <!-- BOT√ìN 1: AGREGAR AL CARRITO (Secundario/Borde) -->
              <button 
                (click)="agregarCarrito()" 
                class="flex-1 py-4 px-4 rounded-full border-2 border-gray-300 text-gray-800 font-bold text-base hover:border-black hover:text-black transition-all duration-200 flex items-center justify-center bg-white active:scale-95"
              >
                Agregar al carrito
              </button>

              <!-- BOT√ìN 2: COMPRAR AHORA (Primario/Negro) -->
              <button 
                (click)="comprar()"
                class="flex-[1.5] bg-black text-white py-4 px-6 rounded-full font-bold text-lg shadow-lg hover:bg-gray-800 hover:shadow-xl hover:-translate-y-0.5 active:scale-95 transition-all duration-200 flex items-center justify-center gap-2"
              >
                <span>Comprar Ahora</span>
                <!-- <span class="font-light opacity-80 text-sm">| S/ {{ p.Precio | number:'1.2-2' }}</span> -->
              </button>
            </div>

            <!-- Garant√≠a debajo de los botones -->
            <p class="text-center text-xs text-gray-500 mt-2 flex items-center justify-center gap-1">
              <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
              Satisfacci√≥n garantizada ‚Ä¢ Checkout Seguro
            </p>
          </div>
          <!-- ================================================== -->

        </div>
      </div>

      

    } 
    @else {
      <div class="text-center py-20 bg-gray-50 rounded-xl">
        <h2 class="text-2xl font-serif text-gray-400 mb-2">Producto no encontrado</h2>
        <button class="text-black underline font-bold hover:text-gray-600">Volver al cat√°logo</button>
      </div>
    }
  }

<!-- ========================================================= -->
<!-- SECCI√ìN 1: INTRODUCCI√ìN (EL PROBLEMA vs LA SOLUCI√ìN)      -->
<!-- √Ångulo: Salud y Naturalidad (Adi√≥s qu√≠micos)              -->
<!-- ========================================================= -->
<section class="bg-white py-16 lg:py-24 overflow-hidden">
  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
      
      <!-- Contenido -->
      <div class="order-2 lg:order-1 space-y-8">
        <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-emerald-50 border border-emerald-100 text-emerald-800 text-xs font-bold tracking-wide uppercase">
          <span class="w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
          Tendencia Skincare 2025
        </div>
        
        <h2 class="text-4xl lg:text-5xl font-serif text-gray-900 leading-tight">
          Tu piel no necesita conservantes.<br>
          <span class="text-gray-400 italic">Necesita naturaleza.</span>
        </h2>
        
        <p class="text-lg text-gray-600 leading-relaxed">
          Las mascarillas convencionales est√°n llenas de qu√≠micos, plomo y conservantes para que duren a√±os en una estanter√≠a. 
          <br><br>
          Con nuestra <strong>M√°quina Inteligente</strong>, creas mascarillas de hidrogel fresco en 5 minutos. Sin aditivos. Solo agua, jugo de frutas y nuestras pastillas de col√°geno activo. Absorci√≥n superior, resultados visibles.
        </p>

        <div class="flex items-center gap-8 pt-4">
          <div class="flex flex-col gap-1">
            <span class="text-3xl font-bold text-gray-900">98%</span>
            <span class="text-xs text-gray-500 uppercase tracking-wider">Absorci√≥n</span>
          </div>
          <div class="w-px h-10 bg-gray-200"></div>
          <div class="flex flex-col gap-1">
            <span class="text-3xl font-bold text-gray-900">0%</span>
            <span class="text-xs text-gray-500 uppercase tracking-wider">Qu√≠micos</span>
          </div>
        </div>
      </div>

      <!-- Imagen Visual -->
      <div class="order-1 lg:order-2 relative">
        <div class="aspect-[4/5] rounded-[2.5rem] overflow-hidden shadow-2xl relative z-10">
          <img src="https://images.unsplash.com/photo-1596704017254-9b1b1b9e8026?q=80&w=800&auto=format&fit=crop" alt="Mujer con piel radiante" class="w-full h-full object-cover">
          <!-- Overlay Gradiente -->
          <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
        </div>
        <!-- Decoraci√≥n Fondo -->
        <div class="absolute top-10 -right-10 w-full h-full border-2 border-emerald-100 rounded-[2.5rem] -z-0 hidden lg:block"></div>
      </div>

    </div>
  </div>
</section>

<!-- ========================================================= -->
<!-- SECCI√ìN 1: EL MANIFIESTO (FRESCO VS PROCESADO)            -->
<!-- Estrategia: Educar sobre el problema oculto (conservantes)-->
<!-- ========================================================= -->
<section class="bg-white py-20 lg:py-32 relative overflow-hidden">
  
  <!-- Decoraci√≥n de fondo sutil -->
  <div class="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-emerald-50/50 to-transparent -z-10"></div>

  <div class="max-w-7xl mx-auto px-6 lg:px-8">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 lg:gap-24 items-center">
      
      <!-- Copy Persuasivo -->
      <div class="space-y-8 animate-in slide-in-from-bottom-8 duration-700">
        <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full bg-black text-white text-[10px] font-bold tracking-widest uppercase shadow-lg">
          <span class="text-xl">‚ú®</span> Nueva Tecnolog√≠a Smart-Mask‚Ñ¢
        </div>
        
        <h2 class="text-5xl lg:text-6xl font-serif text-gray-900 leading-[1.1]">
          ¬øComer√≠as fruta <br>
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-emerald-600 to-teal-500">enlatada hace 2 a√±os?</span>
        </h2>
        
        <p class="text-xl text-gray-500 font-light leading-relaxed">
          Entonces, ¬øpor qu√© pon√©rsela a tu piel? Las mascarillas tradicionales pierden el 60% de sus nutrientes en el estante y dependen de conservantes qu√≠micos.
          <br><br>
          <strong class="text-gray-900 font-medium">La Revoluci√≥n Natural:</strong> Nuestra m√°quina fusiona <strong>Col√°geno Activo</strong> con jugo de fruta fresca al instante. Resultado: 98% de absorci√≥n y 0% de qu√≠micos.
        </p>

        <!-- M√©tricas de Autoridad -->
        <div class="grid grid-cols-3 gap-8 pt-6 border-t border-gray-100">
          <div>
            <p class="text-4xl font-bold text-gray-900 mb-1">5 min</p>
            <p class="text-xs text-gray-400 uppercase tracking-wider font-bold">Tiempo de Prep.</p>
          </div>
          <div>
            <p class="text-4xl font-bold text-gray-900 mb-1">100%</p>
            <p class="text-xs text-gray-400 uppercase tracking-wider font-bold">Natural</p>
          </div>
          <div>
            <p class="text-4xl font-bold text-gray-900 mb-1">24h</p>
            <p class="text-xs text-gray-400 uppercase tracking-wider font-bold">Hidrataci√≥n</p>
          </div>
        </div>
      </div>

      <!-- Imagen Hero con Efecto de Profundidad -->
      <div class="relative group cursor-pointer">
        <div class="absolute inset-0 bg-emerald-200 rounded-[3rem] rotate-6 scale-95 opacity-20 group-hover:rotate-3 transition-transform duration-500"></div>
        <img 
          src="https://images.unsplash.com/photo-1596704017254-9b1b1b9e8026?q=80&w=1000&auto=format&fit=crop" 
          alt="Piel luminosa natural" 
          class="relative rounded-[3rem] shadow-2xl w-full object-cover aspect-[4/5] z-10 group-hover:-translate-y-2 transition-transform duration-500"
        >
        
        <!-- Flotante: Ingrediente -->
        <div class="absolute -left-6 bottom-20 bg-white p-4 rounded-2xl shadow-xl z-20 flex items-center gap-3 animate-bounce-slow">
           <div class="w-12 h-12 bg-red-100 rounded-full flex items-center justify-center text-2xl">üçì</div>
           <div>
             <p class="text-xs text-gray-400 font-bold uppercase">Ingrediente Activo</p>
             <p class="text-sm font-bold text-gray-900">Vitamina C Pura</p>
           </div>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- ========================================================= -->
<!-- SECCI√ìN 2: LA CIENCIA DE LA PASTILLA (EL CORAZ√ìN)         -->
<!-- Estrategia: Dar valor al consumible (Add-on)              -->
<!-- ========================================================= -->
<section class="py-24 bg-gray-900 text-white relative overflow-hidden">
  
  <!-- Fondo abstracto -->
  <div class="absolute top-0 left-0 w-full h-full opacity-10 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')]"></div>

  <div class="max-w-7xl mx-auto px-6 relative z-10">
    <div class="text-center mb-16 max-w-3xl mx-auto">
      <span class="text-emerald-400 font-bold tracking-widest text-xs uppercase mb-2 block">Tecnolog√≠a Bio-Activa</span>
      <h2 class="text-3xl lg:text-5xl font-serif mb-6">El secreto est√° en la <span class="italic text-emerald-400">P√≠ldora</span></h2>
      <p class="text-gray-400 text-lg">No es magia, es biotecnolog√≠a. Nuestra pastilla patentada no es solo col√°geno; es el veh√≠culo que convierte el jugo en una estructura de hidrogel s√≥lido capaz de penetrar la dermis.</p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <!-- Card 1 -->
      <div class="bg-gray-800/50 p-8 rounded-3xl border border-gray-700 hover:border-emerald-500/50 transition-colors group">
        <div class="w-16 h-16 bg-gray-700 rounded-2xl flex items-center justify-center text-3xl mb-6 group-hover:bg-emerald-500 group-hover:text-white transition-colors">üíß</div>
        <h3 class="text-xl font-bold mb-3">Col√°geno Hidrolizado</h3>
        <p class="text-gray-400 text-sm leading-relaxed">P√©ptidos de bajo peso molecular que restauran la elasticidad perdida y rellenan l√≠neas finas.</p>
      </div>

      <!-- Card 2 -->
      <div class="bg-gray-800/50 p-8 rounded-3xl border border-gray-700 hover:border-emerald-500/50 transition-colors group">
        <div class="w-16 h-16 bg-gray-700 rounded-2xl flex items-center justify-center text-3xl mb-6 group-hover:bg-emerald-500 group-hover:text-white transition-colors">üß¨</div>
        <h3 class="text-xl font-bold mb-3">Activador de Enzimas</h3>
        <p class="text-gray-400 text-sm leading-relaxed">Potencia la acci√≥n de las vitaminas de la fruta, evitando que se oxiden durante el proceso.</p>
      </div>

      <!-- Card 3 -->
      <div class="bg-gray-800/50 p-8 rounded-3xl border border-gray-700 hover:border-emerald-500/50 transition-colors group">
        <div class="w-16 h-16 bg-gray-700 rounded-2xl flex items-center justify-center text-3xl mb-6 group-hover:bg-emerald-500 group-hover:text-white transition-colors">ü¶†</div>
        <h3 class="text-xl font-bold mb-3">√Åcido Hialur√≥nico</h3>
        <p class="text-gray-400 text-sm leading-relaxed">Retiene 1000 veces su peso en agua, creando una barrera de hidrataci√≥n instant√°nea.</p>
      </div>
    </div>
  </div>
</section>

<!-- ========================================================= -->
<!-- SECCI√ìN 3: RECETAS DEL CHEF (TU MEN√ö DE BELLEZA)          -->
<!-- Estrategia: Visualizar el uso y la personalizaci√≥n        -->
<!-- ========================================================= -->
<section class="py-24 bg-[#FAFAF9]">
  <div class="max-w-7xl mx-auto px-6">
    
    <div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-6">
      <div>
        <h2 class="text-4xl font-serif text-gray-900 mb-2">Dise√±a tu tratamiento</h2>
        <p class="text-gray-500">T√∫ eres el alquimista. Elige tu ingrediente seg√∫n tu objetivo.</p>
      </div>
      <button class="px-6 py-3 border border-gray-300 rounded-full text-sm font-bold hover:bg-black hover:text-white transition-colors">
        Ver Recetario Completo
      </button>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
      
      <!-- Receta: Anti-Aging -->
      <div class="group relative aspect-[3/4] rounded-3xl overflow-hidden cursor-pointer">
        <img src="https://images.unsplash.com/photo-1596524430615-b46476ddc6aa?q=80&w=600&auto=format&fit=crop" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
        <div class="absolute bottom-0 p-6">
          <div class="bg-white/20 backdrop-blur-md border border-white/30 text-white text-xs font-bold px-3 py-1 rounded-full w-fit mb-3">Piel Madura</div>
          <h3 class="text-2xl text-white font-serif mb-1">Vino Tinto</h3>
          <p class="text-white/80 text-sm">Polifenoles potentes para combatir arrugas profundas.</p>
        </div>
      </div>

      <!-- Receta: Glow -->
      <div class="group relative aspect-[3/4] rounded-3xl overflow-hidden cursor-pointer">
        <img src="https://images.unsplash.com/photo-1582979512210-99b6a53385f9?q=80&w=600&auto=format&fit=crop" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
        <div class="absolute bottom-0 p-6">
          <div class="bg-white/20 backdrop-blur-md border border-white/30 text-white text-xs font-bold px-3 py-1 rounded-full w-fit mb-3">Manchas</div>
          <h3 class="text-2xl text-white font-serif mb-1">Naranja & Miel</h3>
          <p class="text-white/80 text-sm">Vitamina C pura para un brillo instant√°neo y tono uniforme.</p>
        </div>
      </div>

      <!-- Receta: Detox -->
      <div class="group relative aspect-[3/4] rounded-3xl overflow-hidden cursor-pointer">
        <img src="https://images.unsplash.com/photo-1604177091026-42d348a73507?q=80&w=600&auto=format&fit=crop" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
        <div class="absolute bottom-0 p-6">
          <div class="bg-white/20 backdrop-blur-md border border-white/30 text-white text-xs font-bold px-3 py-1 rounded-full w-fit mb-3">Acn√©</div>
          <h3 class="text-2xl text-white font-serif mb-1">Pepino & Aloe</h3>
          <p class="text-white/80 text-sm">Calma la inflamaci√≥n y reduce rojeces al instante.</p>
        </div>
      </div>

      <!-- Receta: Hidrataci√≥n -->
      <div class="group relative aspect-[3/4] rounded-3xl overflow-hidden cursor-pointer">
        <img src="https://images.unsplash.com/photo-1523049673856-006f7a6374e7?q=80&w=600&auto=format&fit=crop" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110">
        <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
        <div class="absolute bottom-0 p-6">
          <div class="bg-white/20 backdrop-blur-md border border-white/30 text-white text-xs font-bold px-3 py-1 rounded-full w-fit mb-3">Piel Seca</div>
          <h3 class="text-2xl text-white font-serif mb-1">Leche & Rosas</h3>
          <p class="text-white/80 text-sm">√Åcido l√°ctico suave para una piel de beb√©.</p>
        </div>
      </div>

    </div>
  </div>
</section>

<!-- ========================================================= -->
<!-- SECCI√ìN 4: PASO A PASO VISUAL (LA SIMPLICIDAD)            -->
<!-- Estrategia: Eliminar el miedo a "es dif√≠cil de usar"      -->
<!-- ========================================================= -->
<section class="py-24 bg-white border-t border-gray-100">
  <div class="max-w-5xl mx-auto px-6">
    
    <div class="text-center mb-16">
      <h2 class="text-4xl font-serif text-gray-900 mb-4">Tan f√°cil como hacer caf√©</h2>
      <p class="text-gray-500">Sin complicaciones. La m√°quina te gu√≠a con voz inteligente en cada paso.</p>
    </div>

    <div class="relative">
      <!-- L√≠nea de conexi√≥n -->
      <div class="hidden md:block absolute top-12 left-20 right-20 h-0.5 bg-gray-100 -z-0 border-t-2 border-dashed border-gray-200"></div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-12">
        
        <!-- Paso 1 -->
        <div class="relative z-10 bg-white text-center group">
          <div class="w-24 h-24 bg-emerald-50 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-sm group-hover:scale-110 transition-transform duration-300 border border-emerald-100">
            <span class="text-4xl">üçπ</span>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-2">1. Vierte</h4>
          <p class="text-sm text-gray-500 leading-relaxed px-4">Agrega 60ml de agua y 20ml de tu jugo favorito. La m√°quina te avisar√° si falta o sobra.</p>
        </div>

        <!-- Paso 2 -->
        <div class="relative z-10 bg-white text-center group">
          <div class="w-24 h-24 bg-emerald-50 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-sm group-hover:scale-110 transition-transform duration-300 border border-emerald-100">
            <span class="text-4xl">üíä</span>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-2">2. Activa</h4>
          <p class="text-sm text-gray-500 leading-relaxed px-4">Introduce la pastilla de col√°geno y presiona "Start". En 5 minutos la mezcla estar√° lista.</p>
        </div>

        <!-- Paso 3 -->
        <div class="relative z-10 bg-white text-center group">
          <div class="w-24 h-24 bg-emerald-50 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-sm group-hover:scale-110 transition-transform duration-300 border border-emerald-100">
            <span class="text-4xl">üíÜ‚Äç‚ôÄÔ∏è</span>
          </div>
          <h4 class="text-xl font-bold text-gray-900 mb-2">3. Disfruta</h4>
          <p class="text-sm text-gray-500 leading-relaxed px-4">Presiona el bot√≥n de salida sobre el molde. Deja enfriar 2 min y apl√≠cala.</p>
        </div>

      </div>
    </div>

  </div>
</section>

<!-- ========================================================= -->
<!-- SECCI√ìN 5: UNBOXING DIGITAL (QU√â INCLUYE)                 -->
<!-- Estrategia: Transparencia total para justificar el precio -->
<!-- ========================================================= -->
<section class="py-20 bg-gray-50">
  <div class="max-w-6xl mx-auto px-6">
    <div class="bg-white rounded-[3rem] p-8 lg:p-12 shadow-xl border border-gray-100 flex flex-col lg:flex-row gap-12 items-center">
      
      <!-- Imagen del Kit -->
      <div class="flex-1 relative w-full aspect-square bg-gray-100 rounded-3xl overflow-hidden">
        <img src="https://images.unsplash.com/photo-1556228720-19075220964b?q=80&w=800&auto=format&fit=crop" alt="Kit Completo" class="absolute inset-0 w-full h-full object-cover mix-blend-multiply p-4">
      </div>

      <!-- Lista de Contenido -->
      <div class="flex-1 space-y-8">
        <div>
          <h3 class="text-3xl font-serif text-gray-900 mb-2">Todo lo que necesitas</h3>
          <p class="text-gray-500">Un kit completo para empezar tu spa en casa desde el d√≠a 1.</p>
        </div>

        <div class="space-y-4">
          <!-- Item Lista -->
          <div class="flex items-center gap-4 p-4 rounded-2xl bg-gray-50 border border-gray-100 hover:border-emerald-200 transition-colors">
            <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-emerald-500 shadow-sm">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            </div>
            <span class="font-bold text-gray-700">M√°quina Inteligente de Mascarillas</span>
          </div>

          <!-- Item Lista -->
          <div class="flex items-center gap-4 p-4 rounded-2xl bg-gray-50 border border-gray-100 hover:border-emerald-200 transition-colors">
            <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-emerald-500 shadow-sm">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            </div>
            <span class="font-bold text-gray-700">1x Caja de Col√°geno (32 Pastillas)</span>
            <span class="ml-auto bg-emerald-100 text-emerald-700 text-[10px] font-bold px-2 py-1 rounded">REGALO</span>
          </div>

          <!-- Item Lista -->
          <div class="flex items-center gap-4 p-4 rounded-2xl bg-gray-50 border border-gray-100 hover:border-emerald-200 transition-colors">
            <div class="w-10 h-10 rounded-full bg-white flex items-center justify-center text-emerald-500 shadow-sm">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
            </div>
            <span class="font-bold text-gray-700">Molde Facial Reutilizable + Esp√°tula</span>
          </div>
        </div>

        <!-- CTA Final -->
        <button (click)="comprar()" class="w-full bg-black text-white py-5 rounded-xl font-bold text-lg hover:bg-gray-800 transition-all shadow-lg hover:-translate-y-1">
          ¬°Lo quiero ahora!
        </button>

      </div>
    </div>
  </div>
</section>


 @if (producto(); as p) {

<!-- ============================================== -->
      <!-- SECCI√ìN RESE√ëAS (INTEGRADA)                    -->
      <!-- ============================================== -->
      <div id="seccion-resenas" class="mt-24">
         <app-reviews-productos [productId]="p.id"></app-reviews-productos>
      </div>
 }